<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="/static/assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="/static/assets/img/favicon.png">
  <title>Booking Form</title>
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900|Roboto+Slab:400,700" />
  <link  href="/static/assets/css/explore-style.css" rel="stylesheet" />
  <link href="/static/assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="/static/assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- <script>
      async function submitBooking(event) {
          event.preventDefault();
          const formData = new FormData(document.getElementById("bookingForm"));
          const data = Object.fromEntries(formData);
          
          try {
              const response = await fetch("/bookings", {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify(data)
              });
              const result = await response.json();
              alert(result.message || result.error);
          } catch (error) {
              console.error("Error:", error);
          }
      }
  </script> -->
  <script>
    async function submitBooking(event) {
        event.preventDefault();
        
        // Get form data
        const form = document.getElementById("bookingForm");
        const formData = new FormData(form);

        // Convert the file to Base64
        const identityFile = formData.get("identity_file");
        if (identityFile) {
            const base64File = await convertToBase64(identityFile);
            formData.set("identity_file", base64File);
        }

        // Convert FormData to a regular object to send as JSON
        const data = Object.fromEntries(formData.entries());

        try {
            // Send the data to the server as JSON
            const response = await fetch("/bookings", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data),
            });
            const result = await response.json();
            alert(result.message || result.error);
        } catch (error) {
            console.error("Error:", error);
        }
    }

    // Convert file to Base64
    function convertToBase64(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onloadend = () => resolve(reader.result);
            reader.onerror = reject;
            reader.readAsDataURL(file);  // This converts the file to Base64
        });
    }
</script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.0/js/all.min.js" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <link id="pagestyle" href="/static/assets/css/material-kit.css?v=3.0.0" rel="stylesheet" />
  <!-- Specific Page CSS goes HERE  -->
  {% block stylesheets %}
  {% endblock stylesheets %}

</head>

<body class="{% block body_class %}{% endblock %} bg-gray-200">

  {% block content %}{% endblock content %}  

  {% include 'includes/scripts.html' %} 

   <!-- Specific Page JS goes HERE  -->
   {% block javascripts %}{% endblock javascripts %}

</body>
</html>
